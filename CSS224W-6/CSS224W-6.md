# 信息传递和节点分类(Message Passing and Node Classification CSS224W 图机器学习)
## 🌎集体分类(Collective Classification)
### 集体分类概述(Collective Classification Overview)
+ 马尔可夫假设: 节点$i$所对应的标签$Y_i$的判别依赖于与其相连的邻居节点的标签.
$$P(Y_i|i) = P(Y_i|N_i)$$
+ 集体分类包含3个步骤:
   + Local Classifier: 用于初始标签分配
      + 基于节点的属性/特征(attributes/features)进行标签预测
      + 标准的分类任务
      + 不适用网络中的信息
   + Relational Classifier: 基于网络捕捉相关性
      + 学习一个分类器，根据其相邻节点的标签和/或属性标记一个节点
      + 这个步骤使用网络中的信息
   + Collective Inference: 传播相关性
      + 对每个节点迭代地应用关系分类器
      + 保持迭代，直到相邻标签之间的不一致性最小化
      + 网络结构在很大程度上影响最终预测

+ 精准推断只有当网络满足一定条件时才是可行的. 对任意的网络而言, 精准推断是一个NP-hard问题.
+ 我们将研究近似推断的技术:
   + 关系分类器
   + 迭代分类器
   + 置信传播

---

## 🌎概率关系分类器(Probabilistic Relational Classifier)
### 基本思路
+ $Y_i$是某一类别的概率是其邻居类别概率的加权平均.
+ 对于已经带有标签的节点而言, 使用其真实的标签$Y$进行初始化.
+ 对于没有标签的节点, 使用均匀分布进行类别初始化.
+ 以随机顺序更新所有节点，直到收敛或达到最大迭代次数.
+ 迭代过程中节点$i$的标签值为$c$的概率是, 其中$W(i,j)$是从$i$到$j$的边的权重:
$$P(Y_i = c) = \frac{1}{\sum_{(i,j)\in E}W(i,j)}\sum_{(i,j)\in E} W(i,j)P(Y_j = c)$$
+ 不足之处:
   + 不能保证收敛
   + 模型没有使用特征信息

---

### 计算举例
+ 初始化
   <div align=center>
       <img src=1.png width=70%/>
   </div>
+ 单次迭代中节点取值的概率变化
   <div align=center>
       <img src=2.png width=70%/>
   </div>
+ 一次迭代后
   <div align=center>
       <img src=3.png width=70%/>
   </div>
+ 四次迭代后
   <div align=center>
       <img src=4.png width=70%/>
   </div>
+ 迭代结果
   <div align=center>
       <img src=5.png width=70%/>
   </div>